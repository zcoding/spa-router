{"version":3,"file":null,"sources":["../../src/utils.js","../../src/listener.js","../../src/querystring.js","../../src/rnode.js","../../src/rtree.js","../../src/api.js","../../src/main.js"],"sourcesContent":["export function extend() {\n  const obj = {};\n  const srcList = Array.prototype.slice.call(arguments, 0);\n  for (let i = 0, len = srcList.length; i < len; ++i) {\n    const src = srcList[i];\n    for (let q in src) {\n      if (src.hasOwnProperty(q)) {\n        obj[q] = src[q];\n      }\n    }\n  }\n  return obj;\n}\n\nexport function removeHashBang (url) {\n  return url.replace(/^#!?/, '');\n}\n\nexport function addEvent(name, handler) {\n  if (window.addEventListener) {\n    window.addEventListener(name, handler, false);\n  } else if (window.attachEvent) {\n    window.attachEvent('on' + name, handler);\n  } else {\n    window['on' + name] = handler;\n  }\n}\n\nexport function warn (message) {\n  if (window['console'] && console.warn) {\n    console.warn(message);\n  }\n}\n\nexport const isArray = Array.isArray ? Array.isArray : function(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n};\n\nexport function makeSureArray (obj) {\n  return isArray(obj) ? obj : (obj ? [obj] : []);\n}\n\nexport function ArrayCopy (arr) {\n  return arr.slice(0);\n}\n","import { extend, addEvent, warn } from './utils';\n\nconst historySupport = typeof window.history['pushState'] !== \"undefined\";\n\nconst MODE = {\n  HASH: 1,\n  HASHBANG: 1,\n  HISTORY: 2\n};\n\nlet RouteMode = MODE.HASHBANG;\n\nlet _init = false;\n\n/// Listener\nconst Listener = {\n  listeners: [],\n\n  setUrlOnly: false,\n\n  setMode (mode) {\n    mode = String(mode).toUpperCase();\n    RouteMode = MODE[mode] || MODE.HASHBANG;\n  },\n\n  init () {\n    if (_init) {\n      return this;\n    }\n    _init = true;\n    if (RouteMode === MODE.HISTORY) { // IE 10+\n      if (historySupport) {\n        addEvent('popstate', onchange);\n      } else {\n        RouteMode = MODE.HASHBANG;\n        // warning\n        warn('ä½ çš„æµè§ˆå™¨ä¸æ”¯æŒ History API ï¼Œåªèƒ½ä½¿ç”¨ hashbang æ¨¡å¼');\n        addEvent('hashchange', onchange);\n      }\n    } else {\n      addEvent('hashchange', onchange);\n    }\n    return this;\n  },\n\n  add (fn) {\n    this.listeners.push(fn);\n    return this;\n  },\n\n  remove (id) {\n    for (let i = 0; i < this.listeners.length; ++i) {\n      if (this.listeners[i].id === id) {\n        this.listeners.splice(i, 1);\n        break;\n      }\n    }\n    return this;\n  },\n\n  setHashHistory (targetURL) {\n    if (RouteMode === MODE.HISTORY) {\n      history.pushState({}, document.title, targetURL);\n    } else {\n      if (targetURL[0] === '/') {\n        location.hash = `!${targetURL}`;\n      } else {\n        let currentURL = location.hash.replace(/^#!?/, ''); // å»æ‰å‰é¢çš„ #!\n        const queryStringIndex = currentURL.indexOf('?');\n        if (queryStringIndex !== -1) {\n          currentURL = currentURL.slice(0, queryStringIndex);\n        }\n        if (/.*\\/$/.test(currentURL)) {\n          location.hash = `!${currentURL}${targetURL}`;\n        } else {\n          const hash = currentURL.replace(/([^\\/]+|)$/, function($1) {\n            return $1 === '' ? '/' + targetURL : targetURL;\n          });\n          location.hash = `!${hash}`;\n        }\n      }\n    }\n    return this;\n  },\n\n  stop () {\n    // remove event listener\n  }\n};\n\nfunction onchange(onChangeEvent) {\n  if (Listener.setUrlOnly) {\n    Listener.setUrlOnly = false;\n    return false;\n  }\n  let listeners = Listener.listeners;\n  for (let i = 0, l = listeners.length; i < l; i++) {\n    listeners[i].handler.call(null, onChangeEvent);\n  }\n}\n\nexport default Listener;\n","const encode = encodeURIComponent, decode = decodeURIComponent;\n\nexport default {\n  /**\n   * querystring.stringify\n   * @param { Object } obj\n   * @param { Boolean } traditional [default:false]\n   * @return { String }\n   *\n   * traditional is true:  {x: [1, 2]} => 'x=1&x=2'\n   * traditional is false: {x: [1, 2]} => 'x[]=1&x[]=2'\n   */\n  stringify: function(obj, traditional) {\n    if (!obj) {\n      return '';\n    }\n    var appendString = traditional ? '' : '[]';\n    var names = Object.keys(obj).sort();\n\n    var parts = [];\n    for (var i = 0; i < names.length; ++i) {\n      var name = names[i];\n      var value = obj[name];\n\n      if (Array.isArray(value)) {\n        value.sort();\n        var _parts = [];\n        for (var j = 0; j < value.length; ++j) {\n          _parts.push(`${encode(name).replace(/%20/g, '+')}${appendString}=${encode(value[j]).replace(/%20/g, '+')}`);\n        }\n        parts.push(_parts.join('&'));\n        continue;\n      }\n      parts.push(`${encode(name).replace(/%20/g, '+')}=${encode(value).replace(/%20/g, '+')}`);\n    }\n    return parts.join('&');\n  },\n\n  /**\n   * querystring.parse\n   * @param { String } queryString\n   * @return { Object }\n   * \n   * 'x=1&y=2' => {x: 1, y: 2}\n   * 'x=1&x=2' => {x: 2}\n   */\n  parse: function(queryString) {\n    if (typeof queryString !== 'string') {\n      return {};\n    }\n\n    queryString = queryString.trim().replace(/^(\\?|#)/, '');\n\n    if (queryString === '') {\n      return {};\n    }\n\n    var queryParts = queryString.split('&');\n\n    let query = {};\n\n    for (let i = 0; i < queryParts.length; ++i) {\n      var parts = queryParts[i].replace(/\\+/g, '%20').split('='); // ç‰¹æ®Šå­—ç¬¦`+`è½¬æ¢ä¸ºç©ºæ ¼\n      var name = parts[0], value = parts[1];\n\n      name = decode(name);\n\n      value = value === undefined ? null : decode(value);\n\n      if (!query.hasOwnProperty(name)) {\n        query[name] = value;\n      } else if (Array.isArray(query[name])) {\n        query[name].push(value);\n      } else {\n        query[name] = [query[name], value];\n      }\n    }\n    return query;\n  }\n};\n","import { isArray, makeSureArray, ArrayCopy } from './utils';\n\n/**\n * RNode\n * @constructor\n * @param {String} value\n *\n * path:          åŒºåˆ†åŒçº§èŠ‚ç‚¹çš„å”¯ä¸€æ ‡è¯†\n * params:        path åŒ…å«çš„å‚æ•°ï¼Œä½¿ç”¨{å‚æ•°å:å‚æ•°è§„åˆ™}é”®å€¼å¯¹è¡¨ç¤º\n * callbacks:     è·¯ç”±åŒ¹é…æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°æˆ–é˜Ÿåˆ—\n * beforeEnter:   è·¯ç”±åŒ¹é…æ—¶ï¼Œcallbacks æ‰§è¡Œä¹‹å‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°æˆ–é˜Ÿåˆ—ï¼ˆå¦‚æœ beforeEnter è¿”å› false åˆ™ä¸ä¼šè¿›å…¥ callbacks æ‰§è¡Œé˜¶æ®µï¼‰\n * beforeLeave:   è·¯ç”±åŒ¹é…æ—¶ï¼Œè¿›å…¥ä¸‹ä¸€ä¸ªè·¯ç”±ä¹‹å‰ï¼ˆä¹Ÿå°±æ˜¯å½“å‰è·¯ç”±ç¦»å¼€ä¹‹å‰ï¼‰æ‰§è¡Œçš„å›è°ƒå‡½æ•°æˆ–é˜Ÿåˆ—\n * children:      å­èŠ‚ç‚¹åˆ—è¡¨å¼•ç”¨\n * parent:        çˆ¶èŠ‚ç‚¹å¼•ç”¨\n */\nfunction RNode(value) {\n  this.path = value;\n  this.params = {};\n  this._hooks = {};\n  this.children = [];\n  this.parent = null;\n}\n\nconst proto = RNode.prototype;\n\nproto.callHooks = function _callHooks (hookName, Req) {\n  const callbacks = this._hooks[hookName] || [];\n  const _copyCallbacks = ArrayCopy(callbacks); // å¤åˆ¶ä¸€ä¸ªï¼Œé¿å…ä¸­é—´è°ƒç”¨äº† off å¯¼è‡´ length å˜åŒ–\n  for (let i = 0; i < _copyCallbacks.length; ++i) {\n    const previousCallbackReturnValue = _copyCallbacks[i].call(null, Req);\n    if (previousCallbackReturnValue === false) break;\n  }\n  return this;\n};\n\nproto.addHooks = function addHooks (hookName, callbacks) {\n  this._hooks[hookName] = makeSureArray(callbacks);\n  return this;\n};\n\n// add children\nproto.addChildren = function addChildren (children) {\n  if (isArray(children)) {\n    this.children = this.children.concat(children);\n  } else {\n    this.children.push(children);\n  }\n  return this;\n};\n\nproto.removeChild = function removeChild (child) {\n  for (let i = 0; i < this.children.length; ++i) {\n    if (this.children[i] === child) {\n      this.children.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\nexport default function createRNode (value) {\n  return new RNode(value);\n}\n","import createRNode from './rnode';\nimport { isArray, makeSureArray } from './utils';\n\n/**\n * æ ¹æ®ç»™å®šçš„ pathï¼Œä»¥ routeTreeRoot ä¸ºæ ¹èŠ‚ç‚¹æŸ¥æ‰¾ï¼Œè¿”å› path å¯¹åº”çš„ rnode èŠ‚ç‚¹\n * å¦‚æœèŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œå¹¶ä¸” createIfNotFound ä¸º true å°±åˆ›å»ºæ–°èŠ‚ç‚¹\n * åŒ¹é…å‚æ•°ï¼ˆå‚æ•°åç”±å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ç»„æˆï¼Œä¸èƒ½ä»¥æ•°å­—å¼€å¤´ã€‚åé¢å¸¦æ‹¬å·çš„æ˜¯ç‰¹å®šå‚æ•°çš„åŒ¹é…è§„åˆ™ã€‚ï¼‰\n * @param {RNode} tree\n * @param {String} path\n * @param {Boolean} createIfNotFound å½“èŠ‚ç‚¹ä¸å­˜åœ¨æ—¶åˆ›å»ºæ–°èŠ‚ç‚¹\n * @return {RNode}\n * */\nexport function findNode(routeTreeRoot, routePath, createIfNotFound) {\n  if (routePath === '') { // å½“å‰èŠ‚ç‚¹\n    return routeTreeRoot;\n  }\n  createIfNotFound = !!createIfNotFound;\n  const parts = routePath.split('/');\n  let target = null, found = false;\n  let parent = routeTreeRoot;\n  let params;\n  for (let i = 0, len = parts.length; i < len; ++i) {\n    params = false;\n    let realCurrentValue = parts[i];\n\n    const matcher = /:([a-zA-Z_][a-zA-Z0-9_]*)(\\([^\\)]+\\))?/g;\n\n    let k = 0;\n\n    function replacement($1, $2, $3) {\n      params = params || [];\n      params[k++] = $2;\n      if (!$3) { // In IE 8 , $3 is an empty String while in other browser it is undefined.\n        return '([a-zA-Z0-9_]+)';\n      } else {\n        return $3;\n      }\n    }\n\n    realCurrentValue = realCurrentValue.replace(matcher, replacement);\n\n    for (let j = 0; j < parent.children.length; ++j ) {\n      if (parent.children[j].path === realCurrentValue) {\n        target = parent.children[j];\n        found = true;\n        break;\n      }\n    }\n    if (!found) { // ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°èŠ‚ç‚¹\n      if (!createIfNotFound) return false;\n      const extendNode = createRNode(realCurrentValue);\n      parent.addChildren(extendNode);\n      extendNode.parent = parent;\n      extendNode.params = params;\n      target = extendNode;\n    }\n    parent = target;\n    found = false;\n  }\n  return target;\n}\n\nfunction createRouteNodeInPath (rootNode, routePath) {\n  routePath = routePath.replace(/^\\/([^\\/]*)/, '$1'); // å»æ‰å‰ç½® /\n  return findNode(rootNode, routePath, true);\n}\n\n// æ„é€ è·¯ç”±æ ‘\nexport function createRouteTree(routeNode, routeOptions) {\n\n  routeNode.addHooks('beforeEnter', routeOptions.beforeEnter);\n  routeNode.addHooks('callbacks', routeOptions.controllers);\n  routeNode.addHooks('beforeLeave', routeOptions.beforeLeave);\n  if (routeOptions.sub) { // å­è·¯ç”±\n    for (let subRoutePath in routeOptions.sub) {\n      if (routeOptions.sub.hasOwnProperty(subRoutePath)) {\n        const subRouteNode = createRouteNodeInPath(routeNode, subRoutePath);\n        createRouteTree(subRouteNode, routeOptions.sub[subRoutePath]);\n      }\n    }\n  }\n\n}\n\n// åˆ›å»ºæ ¹ç»“ç‚¹\nexport function createRootRouteTree (routes) {\n  const rootRouteNode = createRNode('');\n  createRouteTree(rootRouteNode, {\n    sub: routes\n  });\n  return rootRouteNode;\n}\n\n/**\n * @param {RNode} currentRouteNode å½“å‰èŠ‚ç‚¹\n * @param {Array} parts è·¯å¾„åˆ†æ®µæ•°ç»„\n * @param {Integer} ci å½“å‰è·¯å¾„åˆ†æ®µç´¢å¼•\n * @param {Integer} ri å½“å‰èŠ‚ç‚¹æ‰€åœ¨å…„å¼ŸèŠ‚ç‚¹åˆ—è¡¨çš„ä½ç½®\n * @params {Object} params è®°å½•å‚æ•°çš„å¯¹è±¡\n * @return {[RNode, Object]} åŒæ—¶è¿”å›èŠ‚ç‚¹å’Œå‚æ•°\n */\nexport function dfs(currentRouteNode, parts, ci, ri, params) {\n\n  const value = parts[ci];\n\n  var newParams = {};\n  for (var p in params) { // copy: params => newParams\n    if (params.hasOwnProperty(p)) {\n      newParams[p] = params[p];\n    }\n  }\n\n  var parent = currentRouteNode.parent;\n\n  if (parent === null && ri > 0) { // finally not matched\n    return [false, newParams];\n  }\n\n  if (parent !== null && ri > parent.children.length-1) { // not matched, go back\n    return [false, newParams];\n  }\n\n  if (ci > parts.length-1 || ci < 0) return [false, newParams];\n\n  var matcher = new RegExp('^' + currentRouteNode.path + '$');\n  var matches = value.match(matcher);\n\n  if (matches === null) return [false, newParams]; // not matched, go back\n\n  if (!!currentRouteNode.params) {\n    matches = [].slice.apply(matches, [1]);\n    for (var k = 0; k < matches.length; ++k) {\n      newParams[currentRouteNode.params[k]] = matches[k];\n    }\n  }\n\n  if (ci === parts.length-1 && currentRouteNode.callbacks !== null) { // finally matched\n    return [currentRouteNode, newParams];\n  }\n\n  for (var i = 0; i < currentRouteNode.children.length; ++i) {\n    var found = dfs(currentRouteNode.children[i], parts, ci+1, i, newParams); // matched, go ahead\n    if (!found[0]) continue;\n    return found;\n  }\n\n  return dfs(currentRouteNode, parts, ci, ri+1, params); // not matched, go back\n}\n\n/**\n * æœç´¢è·¯ç”±æ ‘ï¼Œçœ‹æ˜¯å¦å­˜åœ¨åŒ¹é…çš„è·¯å¾„ï¼Œå¦‚æœå­˜åœ¨ï¼Œè¿”å›ç›¸åº”çš„å›è°ƒå‡½æ•°\n * @todo åªè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…åˆ°çš„è·¯ç”±ï¼ˆå¦‚æœå­˜åœ¨å¤šä¸ªåŒ¹é…ï¼Ÿï¼‰\n * @param {RNode} tree æ ‘æ ¹\n * @param {String} path è¦åŒ¹é…çš„è·¯å¾„\n * è¿”å›å€¼åŒ…å«ä¸¤ä¸ªï¼Œç”¨æ•°ç»„è¡¨ç¤º[rnode, params]\n * @return {Function|Array|null} å¦‚æœå­˜åœ¨å°±è¿”å›ç›¸åº”çš„å›è°ƒï¼Œå¦åˆ™è¿”å›null\n * @return {[Array, Object]} åŒæ—¶è¿”å›å›è°ƒå’Œå‚æ•°\n *\n * */\nexport function searchRouteTree(tree, path) {\n\n  const result = dfs(tree, path.split('/'), 0, 0, {});\n\n  if (!result[0]) {\n    return [null, {}];\n  }\n\n  return [result[0], result[1]];\n}\n","import { extend, addEvent, isArray, makeSureArray, warn } from './utils';\nimport Listener from './listener';\nimport QS from './querystring';\nimport { findNode, createRouteTree, searchRouteTree } from './rtree';\n\nlet lastReq = null, lastRouteNode = null;\n\nfunction handlerHashbangMode (onChangeEvent) {\n  const newURL = onChangeEvent && onChangeEvent.newURL || location.hash;\n  const url = newURL.replace(/.*#!/, '');\n  this.dispatch(url.charAt(0) === '/' ? url : `/${url}`);\n}\n\nfunction handlerHistoryMode (onChangeEvent) {\n  const url = location.pathname + location.search + location.hash;\n  this.dispatch(url.charAt(0) === '/' ? url : `/${url}`);\n}\n\nexport function start () {\n  if (this._isRunning) { // start åªè°ƒç”¨ä¸€æ¬¡\n    warn('start æ–¹æ³•åªèƒ½è°ƒç”¨ä¸€æ¬¡');\n    return this;\n  }\n  this._isRunning = true;\n  const _handler = this.options.mode === 'history' ? handlerHistoryMode : handlerHashbangMode;\n  const _this = this;\n  Listener.init().add({\n    id: this._uid,\n    handler: function handler () {\n      return _handler.call(_this);\n    }\n  });\n  // é¦–æ¬¡è§¦å‘\n  _handler.call(this);\n  return this;\n}\n\nexport function stop () {\n  Listener.remove(this._uid);\n  this._isRunning = false;\n  return this;\n}\n\nexport function destroy () {\n  this.stop();\n  this._hooks = null;\n  this._rtree = null;\n  return null;\n}\n\n// åŠ¨æ€æ·»åŠ æ–°è·¯ç”±ï¼ˆå¯èƒ½ä¼šæ›¿æ¢åŸæœ‰çš„è·¯ç”±ï¼‰\nexport function mount (routePath, routes) {\n  routePath = routePath.replace(/^\\/([^\\/]*)/, '$1'); // å»æ‰å‰ç½® /\n  const currentRouteNode = findNode(this._rtree, routePath, true);\n  createRouteTree(currentRouteNode, routes);\n  return this;\n}\n\n// æ ¹æ®ç»™å®šçš„è·¯å¾„ï¼Œéå†è·¯ç”±æ ‘ï¼Œåªè¦æ‰¾åˆ°ä¸€ä¸ªåŒ¹é…çš„å°±æŠŠè·¯ç”±è¿”å›\nexport function dispatch (path) {\n  if (typeof path === 'object' && path !== null) { // {name: 'routeName', params: {}}\n  }\n  if (lastReq) {\n    this._callHooks('beforeEachLeave', lastReq);\n    if (lastRouteNode) {\n      lastRouteNode.callHooks('beforeLeave', lastReq);\n    }\n  }\n  const routeTree = this._rtree;\n  // ä¿å­˜åŸå§‹è¯·æ±‚uri\n  const uri = path;\n  const queryIndex = path.indexOf('?');\n  const _hashIndex = path.indexOf('#');\n  const hashIndex = _hashIndex === -1 ? path.length : _hashIndex;\n  const queryString = queryIndex === -1 ? '' : path.slice(queryIndex+1, hashIndex);\n  path = queryIndex === -1 ? path : path.slice(0, queryIndex);\n  const Req = {uri: uri, path: path, query: QS.parse(queryString), $router: this};\n\n  if (path === '/') {\n    path = '';\n  }\n  const result = searchRouteTree(routeTree, path);\n  const routeNode = result[0], params = result[1];\n  Req.params = params;\n  this._callHooks('beforeEachEnter', Req);\n  if (routeNode) {\n    routeNode.callHooks('beforeEnter', Req);\n    routeNode.callHooks('callbacks', Req);\n  }\n  lastReq = Req;\n  lastRouteNode = routeNode;\n  return this;\n}\n\n// åŠ¨æ€æ·»åŠ è·¯ç”±å›è°ƒ\nexport function on (routePath, callbacks) {\n  routePath = routePath.replace(/^\\/([^\\/]*)/, '$1'); // å»æ‰å‰ç½® /\n  const routeNode = findNode(this._rtree, routePath, true);\n  if (!routeNode._hooks['callbacks']) {\n    routeNode.addHooks('callbacks', callbacks);\n  } else {\n    routeNode._hooks['callbacks'] = routeNode._hooks['callbacks'].concat(makeSureArray(callbacks));\n  }\n  return this;\n}\n\n// åŠ¨æ€ç§»é™¤è·¯ç”±å›è°ƒ\nexport function off (routePath, cb) {\n  routePath = routePath.replace(/^\\/([^\\/]*)/, '$1'); // å»æ‰å‰ç½® /\n  const routeNode = findNode(this._rtree, routePath, false);\n  if (routeNode && routeNode._hooks['callbacks']) {\n    if (cb) {\n      for (let i = 0; i < routeNode._hooks['callbacks'].length; ++i) {\n        if (routeNode._hooks['callbacks'][i] === cb) {\n          routeNode._hooks['callbacks'].splice(i, 1);\n          break;\n        }\n      }\n    } else {\n      routeNode._hooks['callbacks'].splice(0, routeNode._hooks['callbacks'].length);\n    }\n  }\n  if (routeNode && routeNode._hooks['callbacks'] && routeNode._hooks['callbacks'].length === 0 && routeNode.children.length === 0 && routeNode.parent) {\n    routeNode.parent.removeChild(routeNode);\n  }\n  return this;\n}\n\n// åŠ¨æ€æ·»åŠ è·¯ç”±å›è°ƒï¼Œä½†æ˜¯åªå“åº”ä¸€æ¬¡\nexport function once (routePath, callbacks) {\n  callbacks = makeSureArray(callbacks);\n  const _this = this;\n  function onlyOnce (req) {\n    for (let i = 0; i < callbacks.length; ++i) {\n      callbacks[i].call(_this, req);\n    }\n    _this.off(routePath, onlyOnce);\n  }\n  return this.on(routePath, onlyOnce);\n}\n\n/**\n * è¿™ä¸ªæ–¹æ³•ä¼šæ”¹å˜å½“å‰çš„ `url`ï¼Œä»è€Œè§¦å‘è·¯ç”±ï¼ˆå’Œ dispatch ç±»ä¼¼ï¼Œä½†æ˜¯ dispatch ä¸ä¼šæ”¹åŠ¨ `url`ï¼‰\n * è¿™ä¸ªæ–¹æ³•å¯¹äº hash/hashbang æ¨¡å¼æ²¡æœ‰å¤šå¤§ç”¨å¤„ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»<a>æ ‡ç­¾å®ç°`url`æ”¹å˜è€Œä¸è·³è½¬é¡µé¢ï¼Œä½†æ˜¯åœ¨historyæ¨¡å¼ä¸‹ï¼Œç”¨æˆ·æ— æ³•é€šè¿‡æ ‡ç­¾æ”¹å˜`url`è€Œä¸è·³è½¬é¡µé¢\n * è¯¥æ–¹æ³•ç›¸å½“äºè°ƒç”¨ä¸€æ¬¡ history.pushState() ç„¶åå†è°ƒç”¨ .dispatch()\n * å¦‚æœ url æ²¡æœ‰æ”¹å˜ï¼Œä¸ä¼š\"åˆ·æ–°\"\n *\n * @param {String} path\n * @return this\n */\nexport function go (path) {\n  var loc = window.location;\n  var oldURI = loc.pathname + loc.search;\n  Listener.setHashHistory(path);\n  var newURI = loc.pathname + loc.search;\n  if (this.options.mode === 'history' && oldURI !== newURI) {\n    this.dispatch(newURI);\n  }\n  return this;\n}\n\nexport function back () {}\n\n// æ”¹å˜å½“å‰çš„ `url` ä½†æ˜¯ä¸è§¦å‘è·¯ç”±\n// å’Œ dispatch åˆšå¥½ç›¸åï¼Œdispatch åªè§¦å‘è·¯ç”±ä½†ä¸æ”¹å˜ `url`\nexport function setUrlOnly (path) {\n  Listener.setUrlOnly = true; // make sure not to trigger anything\n  Listener.setHashHistory(path);\n  return this;\n}\n\n// é‡è½½å½“å‰é¡µé¢\nexport function reload () {\n  if (this.options.mode === 'history') {\n    this.dispatch(`${location.pathname}${location.search}${location.hash}`);\n  } else {\n    this.dispatch(location.hash.replace(/^#!?/, ''));\n  }\n  return this;\n}\n\n// åˆ›å»ºä¸€ä¸ªé“¾æ¥\nexport function createLink (linkTo) {}\n","import {\n  destroy,\n  start,\n  stop,\n  mount,\n  dispatch,\n  on,\n  off,\n  once,\n  go,\n  back,\n  setUrlOnly,\n  reload,\n  createLink\n} from './api';\n\nimport createRNode from './rnode';\nimport { createRootRouteTree } from './rtree';\nimport { extend, makeSureArray } from './utils';\nimport Listener from './listener';\n\nlet uid = 0;\n\n// mode: history|hashbang\n// history     ä½¿ç”¨ HTML5 History API\n// hashbang    ä½¿ç”¨ hashï¼ˆhashbang æ¨¡å¼ï¼‰\nconst optionDefaults = {\n  mode: 'hashbang',\n  recurse: false // TODO\n};\n\n/**\n * Router (routes)\n * @constructor\n * @param {Object} routes **Optional**\n */\n// è™½ç„¶å…è®¸åœ¨åŒä¸€ä¸ªåº”ç”¨åˆ›å»ºå¤šä¸ª Router ï¼Œä½†æ˜¯æ­£å¸¸æƒ…å†µä¸‹ä½ åªéœ€è¦åˆ›å»ºä¸€ä¸ªå®ä¾‹\nexport default function Router(routes, options) {\n  routes = routes || {};\n  this._rtree = createRootRouteTree(routes);\n  this._hooks = {}; // å…¨å±€é’©å­\n  this._init(options);\n}\n\nconst proto = Router.prototype;\n\nproto._init = function _init (options) {\n  options = options || {};\n  this._uid = uid++;\n  this._isRunning = false;\n  this.options = extend({}, optionDefaults, options);\n  Listener.setMode(options.mode);\n  this._hooks['beforeEachEnter'] = makeSureArray(options.beforeEachEnter);\n  this._hooks['beforeEachLeave'] = makeSureArray(options.beforeEachLeave);\n};\n\n// è°ƒç”¨å…¨å±€é’©å­\nproto._callHooks = function _callHooks (hookName, Req) {\n  const callbacks = this._hooks[hookName] || [];\n  for (let i = 0; i < callbacks.length; ++i) {\n    callbacks[i].call(this, Req);\n  }\n};\n\n// start a router\nproto.start = start; // ğŸ†—\n\n// stop a router\nproto.stop = stop; // ğŸ†—\n\n// destroy a router\nproto.destroy = destroy; // ğŸ†—\n\n// mount a sub-route-tree on a route node\nproto.mount = mount; // ğŸ†—\n\n// dynamic add a route to route-tree\nproto.on = on; // ğŸ†—\n\n// like .on except that it will dispatch only once\nproto.once = once; // ğŸ†—\n\n// stop listen to a route\nproto.off = off; // ğŸ†—\n\n// dispatch a route if path matches\nproto.dispatch = dispatch; // ğŸ†—\n\nproto.go = go;\n\nproto.back = back;\n\n// only set url, don't dispatch any routes\nproto.setUrlOnly = setUrlOnly; // ğŸ†—\n\n// redispatch current route\nproto.reload = reload; // ğŸ†—\n"],"names":["extend","obj","srcList","Array","prototype","slice","call","arguments","i","len","length","src","q","hasOwnProperty","addEvent","name","handler","window","addEventListener","attachEvent","warn","message","console","isArray","Object","toString","makeSureArray","ArrayCopy","arr","historySupport","history","MODE","RouteMode","HASHBANG","_init","Listener","mode","String","toUpperCase","HISTORY","onchange","fn","listeners","push","id","splice","targetURL","pushState","document","title","hash","currentURL","location","replace","queryStringIndex","indexOf","test","$1","onChangeEvent","setUrlOnly","l","encode","encodeURIComponent","decode","decodeURIComponent","traditional","appendString","names","keys","sort","parts","value","_parts","j","join","queryString","trim","queryParts","split","query","undefined","RNode","path","params","_hooks","children","parent","proto","callHooks","_callHooks","hookName","Req","callbacks","_copyCallbacks","previousCallbackReturnValue","addHooks","addChildren","concat","removeChild","child","createRNode","findNode","routeTreeRoot","routePath","createIfNotFound","target","found","realCurrentValue","matcher","k","replacement","$2","$3","extendNode","createRouteNodeInPath","rootNode","createRouteTree","routeNode","routeOptions","beforeEnter","controllers","beforeLeave","sub","subRoutePath","subRouteNode","createRootRouteTree","routes","rootRouteNode","dfs","currentRouteNode","ci","ri","newParams","p","RegExp","matches","match","apply","searchRouteTree","tree","result","lastReq","lastRouteNode","handlerHashbangMode","newURL","url","dispatch","charAt","handlerHistoryMode","pathname","search","start","_isRunning","_handler","options","_this","init","add","_uid","stop","remove","destroy","_rtree","mount","routeTree","uri","queryIndex","_hashIndex","hashIndex","QS","parse","$router","on","off","cb","once","onlyOnce","req","go","loc","oldURI","setHashHistory","newURI","back","reload","uid","optionDefaults","Router","setMode","beforeEachEnter","beforeEachLeave"],"mappings":"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"}