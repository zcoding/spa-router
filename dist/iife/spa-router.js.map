{"version":3,"file":null,"sources":["../../src/utils.js","../../src/rnode.js","../../src/listener.js","../../src/querystring.js","../../src/rtree.js","../../src/api.js","../../src/plugin.js","../../src/main.js"],"sourcesContent":["export function extend() {\n  var obj = {};\n  var srcList = Array.prototype.slice.call(arguments, 0);\n  for (var i = 0, len = srcList.length; i < len; ++i) {\n    var src = srcList[i];\n    for (var q in src) {\n      if (src.hasOwnProperty(q)) {\n        obj[q] = src[q];\n      }\n    }\n  }\n  return obj;\n}\n\nexport function addEvent(name, handler) {\n  if (window.addEventListener) {\n    window.addEventListener(name, handler, false);\n  } else if (window.attachEvent) {\n    window.attachEvent('on' + name, handler);\n  } else {\n    window['on' + name] = handler;\n  }\n}\n\nexport function warn (message) {\n  if (window['console'] && console.warn) {\n    console.warn(message);\n  }\n}\n\nexport const isArray = Array.isArray ? Array.isArray : function(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n};\n\nexport function makeSureArray (obj) {\n  return isArray(obj) ? obj : (obj ? [obj] : []);\n}\n","import { isArray, makeSureArray } from './utils';\n\n/**\n * RNode\n * @constructor\n * @param {String} value\n *\n * path:          区分同级节点的唯一标识\n * params:        path 包含的参数，使用{参数名:参数规则}键值对表示\n * callbacks:     路由匹配时执行的回调函数或队列\n * beforeEnter:   路由匹配时，callbacks 执行之前执行的回调函数或队列（如果 beforeEnter 返回 false 则不会进入 callbacks 执行阶段）\n * beforeLeave:   路由匹配时，进入下一个路由之前（也就是当前路由离开之前）执行的回调函数或队列\n * children:      子节点列表引用\n * parent:        父节点引用\n */\nfunction RNode(value) {\n  this.path = value;\n  this.params = {};\n  this._hooks = {};\n  this.children = [];\n  this.parent = null;\n}\n\nconst proto = RNode.prototype;\n\nproto.callHooks = function _callHooks (hookName, Req) {\n  const callbacks = this._hooks[hookName] || [];\n  for (let i = 0; i < callbacks.length; ++i) {\n    callbacks[i].call(this, Req);\n  }\n};\n\nproto.addHooks = function addHooks (hookName, callbacks) {\n  this._hooks[hookName] = makeSureArray(callbacks);\n};\n\n// add children\nproto.addChildren = function addChildren (children) {\n  if (isArray(children)) {\n    this.children = this.children.concat(children);\n  } else {\n    this.children.push(children);\n  }\n  return this;\n};\n\n\nexport default function createRNode (value) {\n  return new RNode(value);\n}\n","import { extend, addEvent, warn } from './utils';\n\nconst historySupport = typeof window.history['pushState'] !== \"undefined\";\n\nlet _mode = 'hashbang';\n\n/// Listener\nconst Listener = {\n  listeners: [],\n\n  setUrlOnly: false,\n\n  init () {\n    if (this.history) { // IE 10+\n      if (historySupport) {\n        addEvent('popstate', onchange);\n      } else {\n        this.history = false;\n        // warning\n        warn('你的浏览器不支持 History API ，只能使用 hashbang 模式');\n        addEvent('hashchange', onchange);\n      }\n    } else {\n      addEvent('hashchange', onchange);\n    }\n    return this;\n  },\n\n  add (fn) {\n    this.listeners.push(fn);\n    return this;\n  },\n\n  setHashHistory (path) {\n    if (this.history) {\n      history.pushState({}, document.title, path);\n    } else {\n      if (path[0] === '/') {\n        location.hash = '!' + path;\n      } else {\n        var currentURL = location.hash.slice(2); // 去掉前面的#!\n        var idf = currentURL.indexOf('?');\n        if (idf !== -1) {\n          currentURL = currentURL.slice(0, idf);\n        }\n        if (/.*\\/$/.test(currentURL)) {\n          location.hash = '!' + currentURL + path;\n        } else {\n          var hash = currentURL.replace(/([^\\/]+|)$/, function($1) {\n            return $1 === '' ? '/' + path : path;\n          });\n          location.hash = '!' + hash;\n        }\n      }\n    }\n    return this;\n  },\n\n  stop () {}\n};\n\nfunction onchange(onChangeEvent) {\n  if (Listener.setUrlOnly) {\n    Listener.setUrlOnly = false;\n    return false;\n  }\n  let listeners = Listener.listeners;\n  for (let i = 0, l = listeners.length; i < l; i++) {\n    listeners[i](onChangeEvent);\n  }\n}\n\nexport default Listener;\n","const encode = encodeURIComponent, decode = decodeURIComponent;\n\nexport default {\n  /**\n   * querystring.stringify\n   * @param { Object } obj\n   * @param { Boolean } traditional [default:false]\n   * @return { String }\n   *\n   * traditional is true:  {x: [1, 2]} => 'x=1&x=2'\n   * traditional is false: {x: [1, 2]} => 'x[]=1&x[]=2'\n   */\n  stringify: function(obj, traditional) {\n    if (!obj) {\n      return '';\n    }\n    var appendString = traditional ? '' : '[]';\n    var names = Object.keys(obj).sort();\n\n    var parts = [];\n    for (var i = 0; i < names.length; ++i) {\n      var name = names[i];\n      var value = obj[name];\n\n      if (Array.isArray(value)) {\n        value.sort();\n        var _parts = [];\n        for (var j = 0; j < value.length; ++j) {\n          _parts.push(`${encode(name).replace(/%20/g, '+')}${appendString}=${encode(value[j]).replace(/%20/g, '+')}`);\n        }\n        parts.push(_parts.join('&'));\n        continue;\n      }\n      parts.push(`${encode(name).replace(/%20/g, '+')}=${encode(value).replace(/%20/g, '+')}`);\n    }\n    return parts.join('&');\n  },\n\n  /**\n   * querystring.parse\n   * @param { String } queryString\n   * @return { Object }\n   * \n   * 'x=1&y=2' => {x: 1, y: 2}\n   * 'x=1&x=2' => {x: 2}\n   */\n  parse: function(queryString) {\n    if (typeof queryString !== 'string') {\n      return {};\n    }\n\n    queryString = queryString.trim().replace(/^(\\?|#)/, '');\n\n    if (queryString === '') {\n      return {};\n    }\n\n    var queryParts = queryString.split('&');\n\n    let query = {};\n\n    for (let i = 0; i < queryParts.length; ++i) {\n      var parts = queryParts[i].replace(/\\+/g, '%20').split('='); // 特殊字符`+`转换为空格\n      var name = parts[0], value = parts[1];\n\n      name = decode(name);\n\n      value = value === undefined ? null : decode(value);\n\n      if (!query.hasOwnProperty(name)) {\n        query[name] = value;\n      } else if (Array.isArray(query[name])) {\n        query[name].push(value);\n      } else {\n        query[name] = [query[name], value];\n      }\n    }\n    return query;\n  }\n};\n","import createRNode from './rnode';\nimport { isArray, makeSureArray } from './utils';\n\n// walk through the routeTree\nexport function walk (routeTree, cb) {\n}\n\n/**\n * 根据给定的 path，以 routeTreeRoot 为根节点查找，返回 path 对应的 rnode 节点\n * 如果节点不存在，并且 createIfNotFound 为 true 就创建新节点\n * 匹配参数（参数名由字母、数字、下划线组成，不能以数字开头。后面带括号的是特定参数的匹配规则。）\n * @param {RNode} tree\n * @param {String} path\n * @param {Boolean} createIfNotFound 当节点不存在时创建新节点\n * @return {RNode}\n * */\nexport function findNode(routeTreeRoot, routePath, createIfNotFound) {\n  if (routePath === '') { // 当前节点\n    return routeTreeRoot;\n  }\n  createIfNotFound = !!createIfNotFound;\n  const parts = routePath.split('/');\n  let target = null, found = false;\n  let parent = routeTreeRoot;\n  let params;\n  for (let i = 0, len = parts.length; i < len; ++i) {\n    params = false;\n    let realCurrentValue = parts[i];\n\n    const matcher = /:([a-zA-Z_][a-zA-Z0-9_]*)(\\([^\\)]+\\))?/g;\n\n    let k = 0;\n\n    /* jshint ignore:start */\n    realCurrentValue = realCurrentValue.replace(matcher, function($1, $2, $3) {\n      params = params || [];\n      params[k++] = $2;\n      if (!$3) { // In IE 8 , $3 is an empty String while in other browser it is undefined.\n        return '([a-zA-Z0-9_]+)';\n      } else {\n        return $3;\n      }\n    });\n    /* jshint ignore:end */\n\n    for (let j = 0; j < parent.children.length; ++j ) {\n      if (parent.children[j].path === realCurrentValue) {\n        target = parent.children[j];\n        found = true;\n        break;\n      }\n    }\n    if (!found) { // 不存在，创建新节点\n      if (!createIfNotFound) return false;\n      const extendNode = createRNode(realCurrentValue);\n      parent.addChildren(extendNode);\n      extendNode.parent = parent;\n      extendNode.params = params;\n      target = extendNode;\n    }\n    parent = target;\n    found = false;\n  }\n  return target;\n}\n\nfunction createRouteNodeInPath (rootNode, routePath) {\n  routePath = routePath.replace(/^\\/([^\\/]*)/, '$1'); // 去掉前置 /\n  return findNode(rootNode, routePath, true);\n}\n\n// 构造路由树\nexport function createRouteTree(routeNode, routeOptions) {\n\n  routeNode.addHooks('beforeEnter', routeOptions.beforeEnter);\n  routeNode.addHooks('callbacks', routeOptions.controllers);\n  routeNode.addHooks('beforeLeave', routeOptions.beforeLeave);\n  if (routeOptions.sub) { // 子路由\n    for (let subRoutePath in routeOptions.sub) {\n      if (routeOptions.sub.hasOwnProperty(subRoutePath)) {\n        const subRouteNode = createRouteNodeInPath(routeNode, subRoutePath);\n        createRouteTree(subRouteNode, routeOptions.sub[subRoutePath]);\n      }\n    }\n  }\n\n}\n\n// 创建根结点\nexport function createRootRouteTree (routes) {\n  const rootRouteNode = createRNode('');\n  createRouteTree(rootRouteNode, {\n    sub: routes\n  });\n  return rootRouteNode;\n}\n\n/**\n * @param {RNode} currentRouteNode 当前节点\n * @param {Array} parts 路径分段数组\n * @param {Integer} ci 当前路径分段索引\n * @param {Integer} ri 当前节点所在兄弟节点列表的位置\n * @params {Object} params 记录参数的对象\n * @return {[RNode, Object]} 同时返回节点和参数\n */\nexport function dfs(currentRouteNode, parts, ci, ri, params) {\n\n  const value = parts[ci];\n\n  var newParams = {};\n  for (var p in params) { // copy: params => newParams\n    if (params.hasOwnProperty(p)) {\n      newParams[p] = params[p];\n    }\n  }\n\n  var parent = currentRouteNode.parent;\n\n  if (parent === null && ri > 0) { // finally not matched\n    return [false, newParams];\n  }\n\n  if (parent !== null && ri > parent.children.length-1) { // not matched, go back\n    return [false, newParams];\n  }\n\n  if (ci > parts.length-1 || ci < 0) return [false, newParams];\n\n  var matcher = new RegExp('^' + currentRouteNode.path + '$');\n  var matches = value.match(matcher);\n\n  if (matches === null) return [false, newParams]; // not matched, go back\n\n  if (!!currentRouteNode.params) {\n    matches = [].slice.apply(matches, [1]);\n    for (var k = 0; k < matches.length; ++k) {\n      newParams[currentRouteNode.params[k]] = matches[k];\n    }\n  }\n\n  if (ci === parts.length-1 && currentRouteNode.callbacks !== null) { // finally matched\n    return [currentRouteNode, newParams];\n  }\n\n  for (var i = 0; i < currentRouteNode.children.length; ++i) {\n    var found = dfs(currentRouteNode.children[i], parts, ci+1, i, newParams); // matched, go ahead\n    if (!found[0]) continue;\n    return found;\n  }\n\n  return dfs(currentRouteNode, parts, ci, ri+1, params); // not matched, go back\n}\n\n/**\n * 搜索路由树，看是否存在匹配的路径，如果存在，返回相应的回调函数\n * @todo 只返回第一个匹配到的路由（如果存在多个匹配？）\n * @param {RNode} tree 树根\n * @param {String} path 要匹配的路径\n * 返回值包含两个，用数组表示[rnode, params]\n * @return {Function|Array|null} 如果存在就返回相应的回调，否则返回null\n * @return {[Array, Object]} 同时返回回调和参数\n *\n * */\nexport function searchRouteTree(tree, path) {\n\n  const result = dfs(tree, path.split('/'), 0, 0, {});\n\n  if (!result[0]) {\n    return [null, {}];\n  }\n\n  return [result[0], result[1]];\n}\n\n// export function removeRNode (rnode) {\n//   const _parent = rnode._parent;\n//   if (_parent) {\n//     for (let i = 0; i < _parent.children.length; ++i) {\n//       if (_parent.children[i] === rnode) {\n//         _parent.children.splice(i, 0);\n//         break;\n//       }\n//     }\n//   }\n//   return rnode;\n// }\n","import { extend, addEvent, isArray } from './utils';\nimport RNode from './rnode';\nimport Listener from './listener';\nimport QS from './querystring';\nimport { findNode, createRouteTree, searchRouteTree } from './rtree';\n\nlet lastReq = null;\n\nconst BeforeLeaveCallbacksQueue = []; // 待调用的 beforeLeave 钩子队列\n\nfunction handlerHashbangMode (onChangeEvent) {\n  var hash = location.hash.slice(1);\n  if (hash === '' || hash === '!') {\n    return this.go('/');\n  }\n  var newURL = onChangeEvent && onChangeEvent.newURL || location.hash;\n  let url = newURL.replace(/.*#!/, '');\n  this.dispatch(url.charAt(0) === '/' ? url : '/' + url);\n}\n\nfunction handlerHistoryMode (onChangeEvent) {\n  let url = location.pathname + location.search + location.hash;\n  if (url.substr(0, 1) !== '/') {\n    url = '/' + url;\n  }\n  this.dispatch(url.charAt(0) === '/' ? url : '/' + url);\n}\n\nexport function start () {\n  const _handler = this._mode === 'history' ? handlerHistoryMode : handlerHashbangMode;\n  const _this = this;\n  Listener.init(this._mode).add(function () {\n    return _handler.call(_this);\n  });\n  // 首次触发\n  _handler.call(this);\n  return this;\n}\n\nexport function stop () {\n  Listener.stop();\n  return this;\n}\n\nexport function destroy () {}\n\n/**\n * @param {String} path\n * @param {Object} routes\n * @return this\n */\nexport function mount (path, routes) {\n  if (path !== '' && path[0] === '/') {\n    path = path.slice(1);\n  }\n  createRouteTree(findNode(this.routeTree, path), routes);\n  return this;\n}\n\n// 根据给定的路径，遍历路由树，只要找到一个匹配的就把路由返回\nexport function dispatch (path) {\n  if (lastReq) {\n    this._callHooks('beforeEachLeave', lastReq);\n  }\n  let routeTree = this._rtree;\n  // 保存原始请求uri\n  let uri = path;\n  var queryIndex = path.indexOf('?');\n  var hashIndex = path.indexOf('#');\n  hashIndex = hashIndex === -1 ? path.length : hashIndex;\n  const queryString = queryIndex === -1 ? '' : path.slice(queryIndex+1, hashIndex);\n  path = queryIndex === -1 ? path : path.slice(0, queryIndex);\n  const Req = {uri: uri, path: path, query: QS.parse(queryString), $router: this};\n\n  if (path === '/') {\n    path = '';\n  }\n  const result = searchRouteTree(routeTree, path);\n  // const callbacks = result[0].callbacks;\n  Req.params = result[1];\n  this._callHooks('beforeEachEnter', Req);\n  if (result[0]) {\n    result[0].callHooks('beforeEnter', Req);\n    result[0].callHooks('callbacks', Req);\n  }\n  // if (callbacks !== null) {\n  //   const _callbacksCopy = callbacks.slice(0); // 复制一个，避免中间调用了 off 导致 length 变化\n  //   for (let i = 0; i < _callbacksCopy.length; ++i) {\n  //     const previousCallbackReturnValue = _callbacksCopy[i].call(this, Req);\n  //     if (previousCallbackReturnValue === false) {\n  //       break;\n  //     }\n  //   }\n  // }\n  lastReq = Req;\n  return this;\n}\n\n/**\n * @param {String|RegExp} path\n * @param {Function|Array} handlers\n * @return this\n */\nexport function on (path, handlers) {\n  if (path !== '' && path[0] === '/') {\n    path = path.slice(1);\n  }\n  var n = findNode(this.routeTree, path);\n  n.callbacks = n.callbacks || [];\n  if (isArray(handlers)) {\n    n.callbacks = n.callbacks.concat(handlers);\n  } else if (typeof handlers === 'function') {\n    n.callbacks.push(handlers);\n  }\n  return this;\n}\n\n/**\n * .off() 方法表示不再侦听某个路由的某个 cb\n * 如果没有指定 cb 则直接将该路由节点的所有 callbacks 移除并设置为 null\n * 如果 callbacks 已经全部移除，则设置为 null\n * @return this\n */\nexport function off (path, cb) {\n  if (path !== '' && path[0] === '/') {\n    path = path.slice(1);\n  }\n  var n = findNode(this.routeTree, path, true);\n  if (n && n.callbacks) {\n    if (cb) {\n      for (let i = 0; i < n.callbacks.length; ++i) {\n        if (n.callbacks[i] === cb) {\n          n.callbacks.splice(i, 1);\n          break;\n        }\n      }\n    } else {\n      n.callbacks.splice(0, n.callbacks.length);\n    }\n    if (n.callbacks.length === 0) {\n      n.callbacks = null;\n    }\n  }\n  return this;\n}\n\n/**\n * 和.on()方法类似，但只会触发一次\n * @param {String|RegExp} path\n * @param {Function|Array} handlers\n * @return this\n */\nexport function once (path, handlers) {\n  const _this = this;\n  function onlyOnce (req) {\n    for (let i = 0; i < handlers.length; ++i) {\n      handlers[i].call(_this, req);\n    }\n    _this.off(path, onlyOnce);\n  }\n  return this.on(path, onlyOnce);\n}\n\n/**\n * 这个方法会改变当前的`url`，从而触发路由（和dispatch类似，但是dispatch不会改动`url`）\n * 这个方法对于hash/hashbang模式没有多大用处，用户可以通过点击<a>标签实现`url`改变而不跳转页面，但是在history模式下，用户无法通过标签改变`url`而不跳转页面\n * 改方法相当于调用一次history.pushState()然后再调用.dispatch()\n * 如果url没有改变，则不\"刷新\"\n *\n * @param {String} path\n * @return this\n */\nexport function go (path) {\n  var loc = window.location;\n  var oldURI = loc.pathname + loc.search;\n  Listener.setHashHistory(path);\n  var newURI = loc.pathname + loc.search;\n  if (this.options.mode === 'history' && oldURI !== newURI) {\n    this.dispatch(newURI);\n  }\n  return this;\n}\n\nexport function back () {}\n\n/**\n * 这个方法会改变当前的 `url` 但是不触发路由\n */\nexport function setUrlOnly (path) {\n  Listener.setUrlOnly = true; // make sure not to trigger anything\n  Listener.setHashHistory(path);\n  return this;\n}\n\n/**\n * reload page: redispatch current path\n * @method\n * @return this\n */\nexport function reload () {\n  if (this.options.mode === 'history') {\n    this.dispatch(location.pathname + location.search + location.hash);\n  } else if (this.options.mode === 'hashbang') {\n    this.dispatch(location.hash.slice(2));\n  } else {\n    this.dispatch(location.hash.slice(1));\n  }\n  return this;\n}\n\nexport function createLink (linkTo) {}\n","export function plugin (register) {}\n","import {\n  destroy,\n  start,\n  stop,\n  mount,\n  dispatch,\n  on,\n  off,\n  once,\n  go,\n  back,\n  setUrlOnly,\n  reload,\n  createLink\n} from './api';\n\nimport { plugin } from './plugin';\nimport createRNode from './rnode';\nimport { createRootRouteTree } from './rtree';\nimport { extend, makeSureArray } from './utils';\n\n// mode: history|hashbang\n// history     使用 HTML5 History API\n// hashbang    使用 hash（hashbang 模式）\nconst optionDefaults = {\n  mode: 'hashbang',\n  recurse: false // TODO\n};\n\n/**\n * Router (routes)\n * @constructor\n * @param {Object} routes **Optional**\n */\n// 虽然允许在同一个应用创建多个 Router ，但是正常情况下你只需要创建一个实例\nexport default function Router(routes, options) {\n  routes = routes || {};\n  this._rtree = createRootRouteTree(routes);\n  this.options = {};\n  this._hooks = {}; // 全局钩子\n  this._init(options);\n}\n\nlet _mode = 'hashbang';\nlet _alreadySetMode = false;\n\nRouter.mode = function setMode (mode) {\n  if (_alreadySetMode) return _mode;\n  _alreadySetMode = true;\n  _mode = mode;\n  return _mode;\n};\n\nconst proto = Router.prototype;\n\nproto._init = function _init (options) {\n  options = options || {};\n  this.options = extend({}, optionDefaults, options);\n  this._hooks['beforeEachEnter'] = makeSureArray(options.beforeEachEnter);\n  this._hooks['beforeEachLeave'] = makeSureArray(options.beforeEachLeave);\n};\n\n// 调用全局钩子\nproto._callHooks = function _callHooks (hookName, Req) {\n  const callbacks = this._hooks[hookName] || [];\n  for (let i = 0; i < callbacks.length; ++i) {\n    callbacks[i].call(this, Req);\n  }\n};\n\n// start a router\nproto.start = start;\n\n// stop a router\nproto.stop = stop\n\n// destroy a router\nproto.destroy = destroy;\n\n// register a plugin\nproto.plugin = plugin;\n\n// mount a sub-route-tree on a route node\nproto.mount = mount;\n\n// dynamic add a route to route-tree\nproto.on = on;\n\n// like .on except that it will dispatch only once\nproto.once = once;\n\n// stop listen to a route\nproto.off = off;\n\n// dispatch a route if path matches\nproto.dispatch = dispatch;\n\nproto.go = go;\n\nproto.back = back;\n\n// only set url, don't dispatch any routes\nproto.setUrlOnly = setUrlOnly;\n\n// redispatch current route\nproto.reload = reload;\n"],"names":["extend","obj","srcList","Array","prototype","slice","call","arguments","i","len","length","src","q","hasOwnProperty","addEvent","name","handler","window","addEventListener","attachEvent","warn","message","console","isArray","Object","toString","makeSureArray","RNode","value","path","params","_hooks","children","parent","proto","callHooks","_callHooks","hookName","Req","callbacks","addHooks","addChildren","concat","push","createRNode","historySupport","history","_mode","Listener","onchange","fn","listeners","pushState","document","title","hash","currentURL","location","idf","indexOf","test","replace","$1","onChangeEvent","setUrlOnly","l","encode","encodeURIComponent","decode","decodeURIComponent","traditional","appendString","names","keys","sort","parts","_parts","j","join","queryString","trim","queryParts","split","query","undefined","findNode","routeTreeRoot","routePath","createIfNotFound","target","found","realCurrentValue","matcher","k","$2","$3","extendNode","createRouteNodeInPath","rootNode","createRouteTree","routeNode","routeOptions","beforeEnter","controllers","beforeLeave","sub","subRoutePath","subRouteNode","createRootRouteTree","routes","rootRouteNode","dfs","currentRouteNode","ci","ri","newParams","p","RegExp","matches","match","apply","searchRouteTree","tree","result","lastReq","handlerHashbangMode","go","newURL","url","dispatch","charAt","handlerHistoryMode","pathname","search","substr","start","_handler","_this","init","add","stop","destroy","mount","routeTree","_rtree","uri","queryIndex","hashIndex","QS","parse","$router","on","handlers","n","off","cb","splice","once","onlyOnce","req","loc","oldURI","setHashHistory","newURI","options","mode","back","reload","plugin","register","optionDefaults","Router","_init","_alreadySetMode","setMode","beforeEachEnter","beforeEachLeave"],"mappings":"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"}